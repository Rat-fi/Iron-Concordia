{% extends "base.html" %}

{% block title %}Meal Preparation Instructions - CUFitness{% endblock %}

{% block content %}
<div class="container py-4">
    <h2 class="text-center mb-4">🍳 Meal Preparation Instructions</h2>
    <p class="text-muted text-center mb-4">Filter meals by dietary needs, budget, calories, and prep time.</p>

    <!-- Filter Form -->
    <form method="get" class="row g-3 mb-5">
        <div class="col-md-3">
            <label for="dietary_restrictions" class="form-label">Dietary Restrictions</label>
            <input type="text" name="dietary_restrictions" id="dietary_restrictions" class="form-control"
                   value="{{ request.GET.dietary_restrictions }}">
        </div>
        <div class="col-md-2">
            <label for="price_min" class="form-label">Min Price ($)</label>
            <input type="number" step="0.01" name="price_min" id="price_min" class="form-control"
                   value="{{ request.GET.price_min }}">
        </div>
        <div class="col-md-2">
            <label for="price_max" class="form-label">Max Price ($)</label>
            <input type="number" step="0.01" name="price_max" id="price_max" class="form-control"
                   value="{{ request.GET.price_max }}">
        </div>
        <div class="col-md-2">
            <label for="prepare_time_max" class="form-label">Max Prep Time (min)</label>
            <input type="number" name="prepare_time_max" id="prepare_time_max" class="form-control"
                   value="{{ request.GET.prepare_time_max }}">
        </div>
        <div class="col-md-2">
            <label for="calories_max" class="form-label">Max Calories</label>
            <input type="number" name="calories_max" id="calories_max" class="form-control"
                   value="{{ request.GET.calories_max }}">
        </div>
        <div class="col-md-2">
            <label for="protein_min" class="form-label">Min Protein (g)</label>
            <input type="number" name="protein_min" id="protein_min" class="form-control"
                   value="{{ request.GET.protein_min }}">
        </div>
        <div class="col-12 text-end mt-3">
            <button type="submit" class="btn btn-primary">🔍 Filter</button>
        </div>
    </form>

    <!-- Instructions Results -->
    {% if instructions %}
        <div class="row row-cols-1 row-cols-md-2 g-4">
            {% for instruction in instructions %}
                <div class="col">
                    <div class="card shadow-sm h-100">
                        <div class="card-body">
                            <h4 class="card-title">{{ instruction.name }} <small class="text-muted">({{ instruction.difficulty }})</small></h4>
                            <ul class="list-unstyled mb-3">
                                <li><strong>🥗 Dietary:</strong> {{ instruction.dietary_restrictions }}</li>
                                <li><strong>💵 Price:</strong> ${{ instruction.price }}</li>
                                <li><strong>⏱️ Prep Time:</strong> {{ instruction.prepare_time }} min</li>
                                <li><strong>🔥 Calories:</strong> {{ instruction.calories }}</li>
                                <li><strong>💪 Protein:</strong> {{ instruction.protein }} g</li>
                            </ul>
                            <h6 class="text-muted">Steps:</h6>
                            <p class="card-text">{{ instruction.steps|linebreaks }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-warning text-center">
            No meal instructions found. Please adjust your filters.
        </div>
    {% endif %}
</div>
{% endblock %}
